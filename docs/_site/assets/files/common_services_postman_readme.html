<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <title>Mines Digital Trust</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
          integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="/mines-digital-trust/assets/css/styles.css">
  </head>
  <body>
    <header>
    <div class="banner">
        <a href="/mines-digital-trust/" alt="British Columbia">
          <img src="/mines-digital-trust/assets/images/BCID_H_rgb_rev.svg" alt="Go to the Government of British Columbia website" class="logo-banner"/>
        </a>
        <h1>Mines Digital Trust</h1>
    </div>
    <div class="other">
    <!--
      This place is for anything that needs to be right aligned
      beside the logo.
    -->
      &nbsp;
    </div>
    </div>
  </header>

    



<nav class="navigation-main" id="navbar">
  <div class="container">
    <ul>
      <li class=""><a href='/mines-digital-trust/'>Overview</a></li>
      <li class="nav-item dropdown ">
        <a class="nav-link dropdown-toggle" href="#" id="compDropdown" role="button" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Services
        </a>
        <div class="dropdown-menu" aria-labelledby="compDropdown">
          
            <a class="dropdown-item" href="/mines-digital-trust/services/bbcm.html">Business to Business Credential Manager</a>
          
            <a class="dropdown-item" href="/mines-digital-trust/services/issuer-agent.html">OrgBook BC Issuer Agent</a>
          
        </div>
      </li>
      <li class="nav-item dropdown  ">
        <a class="nav-link dropdown-toggle" href="#" id="onbDropdown" role="button" data-toggle="dropdown"
          aria-haspopup="true" aria-expanded="false">
          Onboard
        </a>
        <div class="dropdown-menu" aria-labelledby="onbDropdown">
          
            <a class="dropdown-item" href="/mines-digital-trust/onboarding/onboard-option1.html">Issue credentials to OrgBook BC</a>
          
            <a class="dropdown-item" href="/mines-digital-trust/onboarding/onboard-option2.html">Run your own Digital Wallet</a>
          
            <a class="dropdown-item" href="/mines-digital-trust/onboarding/onboard-option3.html">Register with the hosted BCGov Digital Wallet service (coming soon)</a>
          
        </div>
      </li>
      <li class=""><a href='/mines-digital-trust/team.html'>Connect with us</a></li>
    </ul>
  </div>
</nav>

    <div class="content">
      <main role="main">
          <h1 id="common-services-postman-collection">Common Services Postman Collection</h1>
<p>Welcome to the Common Services Postman Collection.</p>

<p>This guide assumes you have gone through the Common Services <a href="https://bcgov.github.io/common-service-showcase/#Onboarding">onboarding process</a> and promoted your service client at least once.  You will need the service client id and password.</p>

<h3 id="services">Services</h3>
<p>Please review the API documents before proceeding. The more familiar you are with the API calls, the more useful you will find the examples in this collection.</p>

<table>
  <thead>
    <tr>
      <th>Service</th>
      <th>Links</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>CHES</td>
      <td><a href="https://github.com/bcgov/common-hosted-email-service">github</a></td>
    </tr>
    <tr>
      <td> </td>
      <td><a href="https://ches.nrs.gov.bc.ca/api/v1/docs">v1 API specification</a></td>
    </tr>
    <tr>
      <td>CDOGS</td>
      <td><a href="https://github.com/bcgov/common-document-generation-service">github</a></td>
    </tr>
    <tr>
      <td> </td>
      <td><a href="https://cdogs.nrs.gov.bc.ca/api/v1/docs#tag/DocGen">v1 API specification</a></td>
    </tr>
    <tr>
      <td> </td>
      <td><a href="https://cdogs.nrs.gov.bc.ca/api/v2/docs#tag/DocGen">v2 API specification</a></td>
    </tr>
  </tbody>
</table>

<h2 id="postman">Postman</h2>
<p>If you have not used <a href="https://www.postman.com">Postman</a>, we recommend that you <a href="https://learning.postman.com">familiarize</a> yourself with it. You can download it <a href="https://www.postman.com/downloads/">here</a>.</p>

<p>Install Postman and get it running, then you can import the <a href="https://bcgov.github.io/common-service-showcase/assets/files/common_services_postman_collection.json">common_services_postman_collection.json</a>.</p>

<h2 id="setup">Setup</h2>
<p>You will need to set the <a href="https://learning.postman.com/docs/postman/collections/intro-to-collections/">collection variables</a>, or run the tests with an <a href="https://learning.postman.com/docs/postman/variables-and-environments/managing-environments/">environment</a> that configures the following:</p>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>auth_host</td>
      <td>Host for authentication service to get client token</td>
    </tr>
    <tr>
      <td>cdogs_host</td>
      <td>Host for CDOGS Service</td>
    </tr>
    <tr>
      <td>ches_host</td>
      <td>Host for CHES Service</td>
    </tr>
    <tr>
      <td>service_client_id</td>
      <td>Set this to <em>YOUR</em> client id from GETOK</td>
    </tr>
    <tr>
      <td>service_client_secret</td>
      <td>Set this to <em>YOUR</em> client secret from GETOK</td>
    </tr>
    <tr>
      <td>email_to</td>
      <td>Set this to <em>YOUR</em> email, you will get emails from CHES</td>
    </tr>
  </tbody>
</table>

<h3 id="environments">Environments</h3>
<p>By default, the hosts are set to the DEV environment.</p>

<table>
  <thead>
    <tr>
      <th>DEV</th>
      <th>URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>auth_host</td>
      <td>https://dev.oidc.gov.bc.ca</td>
    </tr>
    <tr>
      <td>cdogs_host</td>
      <td>https://cdogs-dev.apps.silver.devops.gov.bc.ca</td>
    </tr>
    <tr>
      <td>ches_host</td>
      <td>https://ches-dev.apps.silver.devops.gov.bc.ca</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>TEST</th>
      <th>URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>auth_host</td>
      <td>https://test.oidc.gov.bc.ca</td>
    </tr>
    <tr>
      <td>cdogs_host</td>
      <td>https://cdogs-test.apps.silver.devops.gov.bc.ca</td>
    </tr>
    <tr>
      <td>ches_host</td>
      <td>https://ches-test.apps.silver.devops.gov.bc.ca</td>
    </tr>
  </tbody>
</table>

<table>
  <thead>
    <tr>
      <th>PROD</th>
      <th>URL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>auth_host</td>
      <td>https://oidc.gov.bc.ca</td>
    </tr>
    <tr>
      <td>cdogs_host</td>
      <td>https://cdogs.nrs.gov.bc.ca</td>
    </tr>
    <tr>
      <td>ches_host</td>
      <td>https://ches.nrs.gov.bc.ca</td>
    </tr>
  </tbody>
</table>

<h2 id="overview">Overview</h2>
<p>Once you have set the host and client id/secret variables, you can begin running the API calls. The order of the calls is very important, as each call will set variables that are used in subsequent calls. In particular, you will always want to run “Request a Token” first.  If you encounter any 401 responses, try getting a new token.</p>

<p>Each of the calls has a test (ensuring an expected response, checking headers, response values, etc.). Feel free to familiarize yourself with <a href="https://learning.postman.com/docs/postman/scripts/intro-to-scripts/">tests and scripts</a>. There is code in some Pre-request Scripts and Tests.  For example, setting the delayTS variable for delayed emails is done in a Pre-request Script. All ids used for getting or deleting a particular resource are done in Test scripts (read value, set a collection variable for next test).</p>

<p>In the urls and the request body, you will notice collection variables or test variables like: <code class="language-plaintext highlighter-rouge">,</code> and ``.  In the CDOGS calls, you may notice a different variable substitution: <code class="language-plaintext highlighter-rouge">{d.firstName}</code> - this is for the CDOGS template substitution, not the Postman substitution.  Look at <a href="https://github.com/bcgov/common-document-generation-service/blob/master/app/README.md">CDOGS Application readme</a> for more information.</p>

<h3 id="run-the-collection">Run the collection</h3>
<p>Use the <a href="https://learning.postman.com/docs/postman/collection-runs/intro-to-collection-runs/">collection runner</a> to completely smoke test your credentials and the Common Services environments.  When running the collection, you should de-select the final call: <strong>“CDOGS/upload template (select local template for body)”</strong>, this call requires you to select a local file to upload as a template and cannot be automated.  Also, if you have previously uploaded a file through this call, you can expect to receive a 405 if the template is still in the server cache.</p>

      </main>
    </div>
      <footer class="footer">
    <div class="container">
    <ul>
      <li><a href="https://www.gov.bc.ca/">Home</a></li>
      <li><a href="https://www.gov.bc.ca/">Disclaimer</a></li>
      <li><a href="http://gov.bc.ca/privacy">Privacy</a></li>
      <li><a href="http://gov.bc.ca/webaccessibility">Accessibility</a></li>
      <li><a href="http://gov.bc.ca/copyright">Copyright</a></li>
      <li><a href="https://www2.gov.bc.ca/gov/content/home/contact-us">Contact Us</a></li>
    </ul>
    </div>
  </footer>

<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
  </body>
</html>
